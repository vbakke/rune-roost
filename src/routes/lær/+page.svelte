<script lang="ts">
	import { onMount } from 'svelte';
	import QuillIcon from '$lib/components/icons/QuillIcon.svelte';
	import ScrollIcon from '$lib/components/icons/ScrollIcon.svelte';
	import RavenIcon from '$lib/components/icons/RavenIcon.svelte';

	// Shared random number between 10-99
	let sharedNumber = $state(Math.floor(Math.random() * 90) + 10);

	// Keys for symmetric and asymmetric encryption
	const symmetricKey = 42;
	const asymmetricKey = 17;

	// Computed encrypted values
	let symmetricEncrypted = $derived(sharedNumber + symmetricKey);
	let asymmetricEncrypted = $derived(sharedNumber * asymmetricKey);

	// Hashing: split digits and calculate cross sum
	let digits = $derived(String(sharedNumber).split(''));
	let crossSum = $derived(digits.reduce((sum, digit) => sum + parseInt(digit), 0));
</script>

<div class="container">
	<div class="nav-header">
		<a href="/wÄ«sdÅm" class="skill-tree-link">
			<svg viewBox="0 0 1024 1024" class="icon" version="1.1" xmlns="http://www.w3.org/2000/svg" fill="#000000"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"><path d="M220.046 177.591c3.094 12.374 3.094 17.015 12.374 27.069 4.64 5.414 10.054 10.054 23.975 14.694 20.108 6.187 27.069-5.414 30.162-9.281l7.734 1.547c3.094 1.547 5.414 3.094 5.414 3.094l0.773-3.867-5.414-0.773c-3.867-1.547-6.96-3.094-6.96-3.094s4.64-15.468-6.187-27.842c-26.295-29.389-68.832-12.374-69.605-10.827l5.414 3.094 2.32 6.187zM564.203 285.866c-1.547 0.773 2.32 4.64 0 10.827-0.773 3.094-4.64 6.96-6.96 9.281-16.241 14.694-23.975 19.335-30.936 42.536-3.867 12.374-6.96 23.975-1.547 48.723 7.734 35.576 31.709 37.123 40.216 37.896 1.547 0 3.867 6.96 4.64 12.374 0.773 6.187 0 11.601 0 11.601s3.094 3.867 6.187-2.32c0-0.773-2.32-6.187-3.094-9.281-0.773-6.96-0.773-13.148-0.773-13.148s27.069-6.187 36.349-33.256c22.428-64.965-40.216-116.782-44.083-115.235zM461.343 171.404c1.547 0 3.867 6.96 4.64 12.374 0.773 6.187 0 11.601 0 11.601s3.094 3.867 6.187-2.32c0-0.773-2.32-6.187-3.094-9.281-0.773-6.96-0.773-13.148-0.773-13.148s27.069-5.414 37.123-33.256c21.655-65.738-40.99-117.555-44.083-116.008-1.547 0.773 2.32 4.64 0 10.827-0.773 3.094-4.64 6.96-6.96 9.281-16.241 14.694-23.975 19.335-30.936 42.536-3.867 12.374-6.96 23.975-1.547 48.723 6.96 36.349 30.936 37.123 39.443 38.669zM868.145 361.658c-0.773-0.773-3.094 3.867-8.507 4.64l-10.054-1.547c-18.561-6.187-25.522-10.054-46.403-5.414-10.827 2.32-21.655 5.414-37.896 19.335-24.748 20.881-14.694 40.216-12.374 47.177 0.773 1.547-3.867 6.187-7.734 8.507-4.64 3.867-8.507 4.64-8.507 4.64s-1.547 4.64 3.867 3.867l6.187-6.187c4.64-3.867 10.054-6.187 10.054-6.187s16.241 18.561 40.99 13.921c60.324-10.827 73.472-80.432 70.378-82.753zM495.372 175.271c-3.867 7.734-6.96 16.241-6.187 33.256 1.547 25.522 18.561 28.615 23.975 30.162 0.773 0 1.547 5.414 1.547 9.281 0 4.64-1.547 7.734-1.547 7.734s1.547 3.094 4.64-0.773l-1.547-6.96c0-4.64 0.773-9.281 0.773-9.281s19.335-1.547 28.615-19.335c21.655-43.31-16.241-84.299-18.561-84.299-0.773 0 0.773 3.094-0.773 7.734l-6.187 5.414c-12.374 9.281-17.788 12.374-24.748 27.069zM640.769 226.315l-3.867 7.734c1.547 5.414 4.64 2.32 4.64 2.32s0-4.64 1.547-10.054c1.547-4.64 3.867-10.054 5.414-10.054 6.96 0 28.615 2.32 40.216-27.842 7.734-20.881 6.187-31.709 4.64-42.536-3.094-20.881-9.281-26.295-21.655-40.99l-4.64-8.507c-0.773-6.187 3.094-9.281 1.547-10.054-3.094-1.547-64.191 34.802-53.364 94.353 4.64 25.522 27.842 34.029 27.842 34.029s-0.773 5.414-2.32 11.601zM381.684 553.458c-4.64-2.32-9.281-6.187-9.281-7.734 1.547-6.96 8.507-27.842-19.335-44.857-18.561-11.601-29.389-13.148-40.216-13.921-20.881-1.547-27.069 3.094-44.857 12.374l-10.054 3.094c-6.187-0.773-8.507-4.64-9.281-3.867-2.32 2.32 20.881 69.605 81.206 71.925 25.522 0.773 38.669-20.108 38.669-20.108s5.414 1.547 10.827 4.64l6.96 5.414c6.187 0 3.867-3.867 3.867-3.867s-3.867-0.773-8.507-3.094zM783.846 337.683c14.694-11.601 19.335-19.335 23.202-28.615 6.96-16.241 5.414-22.428 3.094-39.443v-8.507c2.32-4.64 6.187-5.414 5.414-6.187-1.547-2.32-61.871-3.867-81.206 44.083-8.507 20.108 4.64 37.123 4.64 37.123s-3.094 3.867-6.96 6.96l-6.187 3.867c-1.547 4.64 2.32 3.867 2.32 3.867s2.32-3.094 5.414-6.187l8.507-4.64c5.414 2.32 20.108 13.921 41.763-2.32zM497.692 459.878s1.547 3.094 3.094 7.734l0.773 6.187 3.867-0.773s-1.547-2.32-3.094-6.187l-0.773-7.734c3.867-2.32 17.015-9.281 11.601-30.936-3.867-14.694-8.507-20.108-13.921-25.522-10.054-10.054-14.694-10.827-27.842-14.694l-6.187-3.094-3.094-6.187c-2.32 0-22.428 44.083 6.96 72.699 12.374 12.374 28.615 8.507 28.615 8.507zM210.765 302.88c16.241 6.96 29.389-3.094 29.389-3.094l5.414 5.414 3.094 5.414c3.867 1.547 3.094-1.547 3.094-1.547l-5.414-4.64-3.867-6.96c2.32-3.867 11.601-15.468-0.773-32.482-8.507-11.601-15.468-15.468-22.428-18.561-13.148-6.187-17.788-4.64-30.936-3.094l-6.96-0.773c-2.32-1.547-3.094-4.64-3.867-4.64-2.32 1.547-3.867 49.497 33.256 64.965zM260.262 464.518s4.64 1.547 8.507 3.867l5.414 4.64c4.64 0 3.094-3.094 3.094-3.094s-3.867-0.773-7.734-2.32c-3.867-1.547-7.734-4.64-6.96-6.187 0.773-5.414 6.187-22.428-15.468-35.576-14.694-9.281-23.975-10.054-32.482-10.827-17.015-0.773-21.655 3.094-36.349 10.054l-7.734 2.32c-4.64 0-6.96-3.867-7.734-3.094-1.547 2.32 17.015 56.457 66.511 57.231 20.881-0.773 30.936-17.015 30.936-17.015zM373.176 195.379c-12.374-7.734-17.015-6.96-30.162-6.96l-6.96-1.547c-3.094-2.32-3.094-5.414-4.64-5.414-2.32 0.773-10.054 47.95 25.522 68.832 14.694 8.507 29.389 0.773 29.389 0.773s3.094 3.094 4.64 6.187l2.32 5.414c3.867 1.547 3.094-1.547 3.094-1.547l-3.867-4.64-3.094-7.734c3.094-3.867 13.921-13.921 3.094-32.482-6.96-13.148-13.148-17.015-19.335-20.881zM511.613 502.414l-5.414-4.64c-1.547-3.867 0-6.187-1.547-6.187-2.32 0-32.482 37.123-11.601 71.925 8.507 14.694 25.522 14.694 25.522 14.694l1.547 7.734-0.773 6.187c2.32 3.094 3.867 0.773 3.867 0.773l-1.547-6.187c0-3.094 0-7.734 0.773-7.734 4.64-1.547 18.561-5.414 18.561-27.069 0-14.694-3.094-21.655-6.96-27.842-6.187-13.148-10.827-15.468-22.428-21.655zM568.844 263.437s-0.773 3.867-2.32 7.734l-3.867 4.64c0.773 3.867 3.094 2.32 3.094 2.32s0-3.094 1.547-6.187l4.64-6.187c4.64 0.773 18.561 3.867 29.389-15.468 6.96-13.148 6.96-20.108 6.96-27.842 0-13.921-3.867-18.561-10.827-29.389l-2.32-6.187c0-3.867 2.32-5.414 1.547-6.187-1.547-1.547-45.63 17.788-43.31 58.778 0.773 16.241 15.468 23.975 15.468 23.975zM647.729 354.697s-0.773 3.867-3.094 7.734l-3.867 4.64c0 3.867 3.094 2.32 3.094 2.32s0.773-3.094 2.32-6.187l4.64-6.187c4.64 0.773 18.561 4.64 29.389-14.694 6.96-13.148 7.734-20.108 7.734-27.842 0-13.921-3.094-18.561-10.054-29.389l-2.32-6.187c0-3.867 3.094-5.414 2.32-6.187-1.547-1.547-46.403 16.241-45.63 57.231 1.547 16.241 15.468 24.748 15.468 24.748zM378.59 309.067l-3.094-6.187c-2.32 0-19.335 44.857 11.601 71.925 13.148 11.601 28.615 6.187 28.615 6.187s2.32 3.094 3.867 6.96l1.547 6.187 3.867-0.773s-2.32-2.32-3.094-6.187l-1.547-7.734c3.867-3.094 16.241-10.827 9.281-31.709-4.64-13.921-10.054-19.335-15.468-24.748-10.054-10.054-15.468-10.054-28.615-13.148l-6.96-0.773zM266.449 411.928c5.414 11.601 11.601 22.428 32.482 36.349 30.162 20.881 48.723 4.64 54.911 0 1.547-0.773 7.734 2.32 11.601 6.187 4.64 3.867 7.734 8.507 7.734 8.507s5.414 0.773 3.094-5.414l-8.507-4.64c-5.414-3.867-10.054-9.281-10.054-9.281s15.468-23.202 3.094-49.497c-28.615-62.644-109.048-56.457-111.368-53.364-0.773 1.547 4.64 2.32 7.734 7.734 1.547 3.094 1.547 7.734 1.547 11.601-1.547 21.655-3.094 30.162 7.734 51.817zM340.694 280.452c-14.694-44.083-70.378-45.63-71.925-43.31-0.773 0.773 3.094 1.547 4.64 6.187v7.734c-2.32 14.694-4.64 20.108 0.773 35.576 3.094 7.734 6.187 15.468 19.335 27.069 18.561 16.241 32.482 6.96 37.123 3.867l7.734 4.64 4.64 6.187s3.867 0.773 2.32-3.867l-5.414-3.867c-3.094-3.094-6.187-6.96-6.187-6.96s13.148-14.694 6.96-33.256zM761.417 170.631c-0.773 0-0.773 3.094-3.867 6.187l-7.734 2.32c-14.694 2.32-20.881 2.32-33.256 12.374-6.96 5.414-13.148 10.827-19.335 27.069-9.281 23.202 3.867 32.482 8.507 36.349 0.773 0.773-0.773 5.414-2.32 8.507-1.547 3.867-4.64 6.187-4.64 6.187s0 3.867 3.867 0.773l1.547-6.187c2.32-4.64 4.64-7.734 4.64-7.734s18.561 7.734 34.029-4.64c38.669-27.842 21.655-80.432 18.561-81.206zM324.453 127.321c2.32 8.507 4.64 16.241 16.241 28.615 17.015 17.788 31.709 9.281 36.349 7.734l6.96 5.414 3.867 6.187s3.094 1.547 2.32-3.094l-5.414-4.64c-3.094-3.867-5.414-7.734-5.414-7.734s14.694-13.921 10.054-33.256c-10.827-45.63-65.738-51.817-67.285-49.497-0.773 0.773 3.094 2.32 3.867 6.187l-0.773 7.734c-2.32 15.468-4.64 20.881-0.773 36.349zM213.085 388.726c0.773-0.773 5.414 0.773 8.507 2.32 3.867 1.547 6.187 4.64 6.187 4.64s3.867 0 0.773-3.867l-6.187-2.32-7.734-4.64s7.734-18.561-3.867-34.029c-27.842-37.896-80.432-22.428-81.206-19.335 0 0.773 3.094 0.773 6.187 3.867l2.32 7.734c1.547 14.694 1.547 20.881 11.601 33.256 5.414 6.96 10.827 13.148 26.295 19.335 23.202 10.054 33.256-3.094 37.123-6.96zM501.559 305.2c-1.547-17.015-6.187-23.975-10.827-30.936-9.281-13.148-14.694-15.468-28.615-21.655l-6.187-4.64c-2.32-3.867-0.773-6.96-2.32-6.96-2.32 0-34.029 45.63-6.187 83.526 11.601 16.241 31.709 13.921 31.709 13.921s1.547 3.867 2.32 8.507v6.96c3.094 3.867 3.867 0 3.867 0s-1.547-3.094-2.32-6.96c-0.773-3.867-0.773-8.507 0.773-9.281 4.64-2.32 20.108-7.734 17.788-32.482zM405.659 420.435c-0.773 0.773 2.32 3.094 1.547 7.734l-3.094 6.96c-8.507 12.374-13.148 16.241-13.921 32.482-0.773 8.507-0.773 17.015 6.187 32.482 10.054 22.428 26.295 19.335 31.709 19.335 0.773 0 3.867 3.867 4.64 7.734 1.547 3.867 1.547 7.734 1.547 7.734s3.094 2.32 3.867-2.32l-3.094-6.187c-1.547-4.64-2.32-8.507-2.32-8.507s17.788-7.734 20.108-27.842c5.414-47.177-44.857-71.152-47.177-69.605zM694.906 370.165l-3.867 6.96-6.96 3.094c-14.694 3.094-20.108 3.867-32.482 15.468-6.187 6.187-11.601 12.374-17.015 27.842-6.96 23.975 6.96 32.482 11.601 35.576 0.773 0.773 0 5.414-1.547 9.281s-3.867 6.96-3.867 6.96 0.773 3.867 3.867 0.773l1.547-6.96c1.547-4.64 3.867-8.507 3.867-8.507s19.335 6.187 33.256-7.734c35.576-31.709 14.694-82.753 11.601-82.753zM575.804 133.508c0.773 0 1.547 5.414 1.547 9.281s-1.547 7.734-1.547 7.734 1.547 3.094 3.867-0.773l-0.773-6.96c0-4.64 1.547-9.281 1.547-9.281s20.108 0 30.162-17.015c23.975-40.216-10.827-82.753-13.921-82.753-0.773 0 0.773 3.094-1.547 7.734l-6.187 4.64c-13.148 7.734-18.561 10.054-26.295 23.975-3.867 7.734-7.734 14.694-7.734 31.709 0 26.295 15.468 30.162 20.881 31.709z" fill="#148d13"></path><path d="M650.050 620.743c-155.451 192.574-73.472 341.838-46.403 352.665 3.094 1.547-122.969 4.64-121.422 3.867 58.778-35.576-64.191-318.636-87.393-367.36-9.281-19.335 9.281 2.32 43.31-10.827 27.069-10.827 19.335-40.99 35.576-34.029 12.374 5.414-3.867 50.27 21.655 91.26 4.64 7.734 71.925 9.281 73.472-129.156 0.773-62.644 28.615 6.96 55.684 17.788s35.576 6.96 91.26-69.605c5.414-9.281 47.177 5.414-65.738 145.397z" fill="#824522"></path></g></svg>
			Knowledge Tree
		</a>
		<h1>LÃ¦ran - Encryption Concepts</h1>
		<div/>
	</div>

	<!-- Symmetric Pane -->
	<div id="symmetric" class="pane">
		<div class="pane-header">
			<h2>Symmetric</h2>
			<a href="/lÃ¦r/symmetric" class="lesson-button">
				<RavenIcon />
				<span>Learn</span>
			</a>
		</div>
		<div class="encryption-flow">
			<div class="desk scribe">
				<input
					type="number"
					bind:value={sharedNumber}
					min="10"
					max="99"
					class="desk-input"
				/>
				<div class="desk-icon">
                    <QuillIcon />
				</div>
			</div>

			<div class="key">
				<div class="key-icon">ðŸ”‘</div>
				<div class="key-value">{symmetricKey}</div>
			</div>

			<div class="arrow">â†’</div>

			<div class="desk scroll">
				<div class="desk-icon"><ScrollIcon /></div>
				<div class="desk-output">{symmetricEncrypted}</div>
			</div>
		</div>
	</div>

	<!-- Asymmetric Pane -->
	<div id="asymmetric" class="pane">
		<div class="pane-header">
			<h2>Asymmetric</h2>
			<a href="/lÃ¦r/asymmetric" class="lesson-button">
				<RavenIcon />
				<span>Learn</span>
			</a>
		</div>
		<div class="encryption-flow">
			<div class="desk scribe">
				<input
					type="number"
					bind:value={sharedNumber}
					min="10"
					max="99"
					class="desk-input"
				/>
				<div class="desk-icon">
					<QuillIcon />
				</div>
			</div>

			<div class="key">
				<div class="key-icon">ðŸ”‘</div>
				<div class="key-value">{asymmetricKey}</div>
			</div>

			<div class="arrow">â†’</div>

			<div class="desk scroll">
				<div class="desk-icon"><ScrollIcon /></div>
				<div class="desk-output">{asymmetricEncrypted}</div>
			</div>
		</div>
	</div>

	<!-- Hashing Pane -->
	<div id="hashing" class="pane">
		<div class="pane-header">
			<h2>Hashing</h2>
			<a href="/lÃ¦r/hashing" class="lesson-button">
				<RavenIcon />
				<span>Learn</span>
			</a>
		</div>
		<div class="encryption-flow">
			<div class="desk scribe">
				<input
					type="number"
					bind:value={sharedNumber}
					min="10"
					max="99"
					class="desk-input"
				/>
				<div class="desk-icon">
					<QuillIcon />
				</div>
			</div>

			<div class="desk hash-function">
				{#each digits as digit, i}
					<span class="digit">{digit}</span>
					{#if i < digits.length - 1}
						<span class="plus">+</span>
					{/if}
				{/each}
			</div>

			<div class="arrow">â†’</div>

			<div class="desk scroll">
				<div class="desk-icon"><ScrollIcon /></div>
				<div class="desk-output">{crossSum}</div>
			</div>
		</div>
	</div>
</div>

<style>
	.container {
		max-width: 1200px;
		margin: 0 auto;
		padding: 1rem;
	}

	.nav-header {
		display: flex;
		flex-direction: row;
		align-items: center;
		justify-content: space-between;
		margin-bottom: 1rem;
	}

	.skill-tree-link {
		display: inline-flex;
		align-items: center;
		gap: 0.5rem;
		color: #667eea;
		text-decoration: none;
		font-weight: 600;
		padding: 0.5rem 1rem;
		border-radius: 8px;
		transition: background-color 0.2s;
	}

	.skill-tree-link:hover {
		background-color: rgba(102, 126, 234, 0.1);
	}

	h1 {
		text-align: center;
		margin-bottom: 1rem;
		font-size: 2rem;
	}

	.pane {
		background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
		border-radius: 12px;
		padding: 1rem 1.5rem;
		margin-bottom: 0.75rem;
		box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
		scroll-margin-top: 2rem;
	}

	h2 {
		color: white;
		margin-top: 0;
		margin-bottom: 0.75rem;
		font-size: 1.3rem;
		display: inline-block;
		margin-right: 1rem;
		width: 120px;
		text-align: left;
	}

	.pane-header {
		display: flex;
		align-items: center;
		justify-content: space-between;
		margin-bottom: 0.75rem;
	}

	.lesson-button {
		display: flex;
		align-items: center;
		gap: 0.5rem;
		background: rgba(255, 255, 255, 0.2);
		padding: 0.5rem 1rem;
		border-radius: 8px;
		text-decoration: none;
		color: white;
		font-weight: 600;
		transition: all 0.2s;
		border: 2px solid rgba(255, 255, 255, 0.3);
	}

	.lesson-button:hover {
		background: rgba(255, 255, 255, 0.3);
		transform: translateY(-2px);
		box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
	}

	.encryption-flow {
		display: inline-flex;
		align-items: center;
		justify-content: center;
		gap: 1.5rem;
		flex-wrap: wrap;
	}

	.desk {
		display: flex;
		flex-direction: row;
		align-items: center;
		gap: 0.75rem;
		background: rgba(255, 255, 255, 0.9);
		padding: 0.75rem 1rem;
		border-radius: 8px;
		box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
	}

	.desk-icon {
		font-size: 2rem;
		display: flex;
		align-items: center;
	}

	.desk-input,
	.desk-output {
		font-size: 2rem;
		font-weight: bold;
		text-align: center;
		min-width: 80px;
		border: none;
		background: transparent;
		color: #333;
	}

	.desk-input {
		border-bottom: 2px solid #667eea;
		padding: 0.25rem;
	}

	.desk-input:focus {
		outline: none;
		border-bottom-color: #764ba2;
	}

	.desk.scroll {
		background-color: #8574e3;
	}

	.key {
		display: flex;
		flex-direction: column;
		align-items: center;
		gap: 0.25rem;
	}

	.key-icon {
		font-size: 2rem;
	}

	.key-value {
		font-size: 1.4rem;
		font-weight: bold;
		color: #ecdfff;
		background: rgba(0, 0, 0, 0.2);
		padding: 0.25rem 0.75rem;
		border-radius: 8px;
	}

	.arrow {
		font-size: 2.5rem;
		color: white;
		font-weight: bold;
	}

	.desk.hash-function {
		background-color: #5654a4;
	}

	.digit {
		font-size: 1.75rem;
		font-weight: bold;
		color: #ecdfff;
	}

	.plus {
		font-size: 1.25rem;
		color: #ecdfff;
		font-weight: bold;
	}

	@media (max-width: 768px) {
		h2 {
			display: block;
			font-size: 1.5rem;
			margin-bottom: 1rem;
		}

		.encryption-flow {
			display: flex;
			flex-direction: column;
			gap: 1rem;
		}

		.desk {
			flex-direction: column;
			padding: 1rem;
		}

		.desk-icon {
			font-size: 2.5rem;
		}

		.desk-input,
		.desk-output {
			font-size: 2rem;
			min-width: 100px;
		}

		.arrow {
			transform: rotate(90deg);
		}

		h1 {
			font-size: 2rem;
		}
	}
</style>
